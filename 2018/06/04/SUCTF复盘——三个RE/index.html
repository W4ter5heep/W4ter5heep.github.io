<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>SUCTF复盘——三个RE | W4ter5heep&#39;s site</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="CTF,RE">
    <meta name="description" content="RoughLike与期末大作业.Net逆向首先承认，比赛的时候因为手比较快下载的是有img文件夹的压缩包，但是很迷，上午提交截图的flag提示错误，下午就对了。。。                                                                                             Alt text">
<meta name="keywords" content="CTF,RE">
<meta property="og:type" content="article">
<meta property="og:title" content="SUCTF复盘——三个RE">
<meta property="og:url" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/index.html">
<meta property="og:site_name" content="W4ter5heep&#39;s site">
<meta property="og:description" content="RoughLike与期末大作业.Net逆向首先承认，比赛的时候因为手比较快下载的是有img文件夹的压缩包，但是很迷，上午提交截图的flag提示错误，下午就对了。。。                                                                                             Alt text">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527601594188.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527601674717.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527642510738.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527866689432.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527866932928.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527869996737.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527871120681.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527871198779.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527871225771.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527871268243.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527872148100.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527872277037.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527872767267.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527874571861.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527874804833.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527875069592.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527900424443.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527900566263.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527908197009.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527908206823.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527909005594.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527909263500.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527909344106.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527909422356.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527909512441.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527909689435.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527909700557.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527909809808.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527910679359.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527910745369.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527910774816.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527911287081.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527911593518.png">
<meta property="og:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527911726618.png">
<meta property="og:updated_time" content="2018-06-04T13:14:28.992Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SUCTF复盘——三个RE">
<meta name="twitter:description" content="RoughLike与期末大作业.Net逆向首先承认，比赛的时候因为手比较快下载的是有img文件夹的压缩包，但是很迷，上午提交截图的flag提示错误，下午就对了。。。                                                                                             Alt text">
<meta name="twitter:image" content="http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/1527601594188.png">
    
        <link rel="alternate" type="application/atom+xml" title="W4ter5heep&#39;s site" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu"  >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/gogo.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">W4ter5heep</h5>
          <a href="mailto:w4ter5heep@qq.com" title="w4ter5heep@qq.com" class="mail">w4ter5heep@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/w4ter5heep" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/friendlinks"  >
                <i class="icon icon-lg icon-address-book"></i>
                友链
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">SUCTF复盘——三个RE</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="global.search_input_hint">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">SUCTF复盘——三个RE</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-06-04T13:01:02.000Z" itemprop="datePublished" class="page-time">
  2018-06-04
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/WriteUp/">WriteUp</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#RoughLike与期末大作业"><span class="post-toc-number">1.</span> <span class="post-toc-text">RoughLike与期末大作业</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#simpleformat"><span class="post-toc-number">2.</span> <span class="post-toc-text">simpleformat</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#enigma"><span class="post-toc-number">3.</span> <span class="post-toc-text">enigma</span></a></li></ol>
        </nav>
    </aside>


<article id="post-SUCTF复盘——三个RE"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">SUCTF复盘——三个RE</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-06-04 21:01:02" datetime="2018-06-04T13:01:02.000Z"  itemprop="datePublished">2018-06-04</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/WriteUp/">WriteUp</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="RoughLike与期末大作业"><a href="#RoughLike与期末大作业" class="headerlink" title="RoughLike与期末大作业"></a>RoughLike与期末大作业</h2><p>.Net逆向<br>首先承认，比赛的时候因为手比较快下载的是有img文件夹的压缩包，但是很迷，上午提交截图的flag提示错误，下午就对了。。。<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527601594188.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527601674717.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure></p>
<p>更新后题目的目录结构如下：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527642510738.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure>
<p>可以发现dll文件非常大，反倒是主程序比较小<br>在test_Data中找到比较多的文件<br>但好像运行报错？<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527866689432.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>还要改文件夹名字。。。</p>
<p>hint提示要看过场动画<br>首先可以看到开始的过场动画：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527866932928.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>说明flag有两段？有点牵强。。。</p>
<p>尝试玩了几关，没什么发现，并且动作缓慢</p>
<p>得到第二段flag的一种方法：<br>查看Data文件夹中的level1文件，使用010editor直接搜索字符串，找到：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527869996737.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>得到第二段flag：<code>_70_5uc7F</code><br>有点不讲道理</p>
<p>得到第一段flag方法：<br>首先要知道Managed文件夹中Dotfuscated是因为对.NET进行了混淆：<br>使用De4dot对Dotfuscated的Assembly-CSharp.dll进行去混淆，该工具在吾爱破解工具包中就有。<br>然后使用.NET Reflator进行反编译，搜索关键词找到关键函数：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527871120681.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>有两个decrypt函数：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527871198779.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure></p>
<p>内容：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527871225771.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527871268243.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>满足这两个条件即会在地图上随机位置生成一个flag，但是条件比较苛刻：<br>12&lt;&lt;8|12&gt;&gt;0x18<br>目测是一个很大的数<br>第二个也同样</p>
<p>可以通过修改初始参数值使条件满足，但是这里想办法分析函数：<br>这里要查找S3cretArray数组初始化的位置是LoadBundle：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527872148100.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>继续追踪到解密函数：<br>DecryptAssetBundle(<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527872277037.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>前几天刚做了一个题，目测是索引表变了以后的base64</p>
<p>要解密的文件是：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527872767267.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>解密脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line">import base64</span><br><span class="line"> </span><br><span class="line">custom  = &quot;QRSTUVWXYZABCDEFGHIJKLMNOPabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><span class="line">standard= &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><span class="line"> </span><br><span class="line">plainText=&quot;GetProcAddr&quot;</span><br><span class="line"> </span><br><span class="line">def decryptbundle(pathname,dst):</span><br><span class="line">	decode=&quot;&quot;</span><br><span class="line">	with open(&quot;/Users/ilan/Desktop/SUCTF/re/Output/test_Data/StreamingAssets/bundles/%s&quot;%(pathname),&quot;rb&quot;) as f:</span><br><span class="line">		encode=f.read()</span><br><span class="line">	for ch in encode:</span><br><span class="line">		if(ch in custom):</span><br><span class="line">			decode=decode+standard[string.find(custom,str(ch))]</span><br><span class="line">		elif(ch == &apos;=&apos;):</span><br><span class="line">			decode= decode+&apos;=&apos;</span><br><span class="line">	decode=base64.b64decode(decode)</span><br><span class="line">	with open(dst,&quot;wb&quot;) as f:</span><br><span class="line">		f.write(decode)</span><br><span class="line"> </span><br><span class="line">decryptbundle(&quot;WeaponYourself.assetbundle&quot;,&quot;ext1&quot;)</span><br></pre></td></tr></table></figure></p>
<p>此时对解密后的文件进行解析即可：<br>利用工具解析文件，中间需要经过一步解压缩，搜索二进制文件的“flag”可以得到：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527874571861.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>第一部分flag的base64<br>也可以使用python的第三方库解压读取文件内容：<br><a href="https://github.com/HearthSim/UnityPack" target="_blank" rel="noopener">https://github.com/HearthSim/UnityPack</a></p>
<p>在此基础上，可以通过分析代码的方式找到前半段Flag：<br>在场景初始化函数中找到：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527874804833.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure></p>
<p>满足判断条件会设置为True<br>条件为满足关卡数目和99整除且defeatedBoss数量大于0x72000000且defeatedMonster大于514时，会设置一个文本SPText标志位为true。</p>
<p>不可能完成的任务</p>
<p>因此可以直接设置SPText标志为True：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527875069592.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>然后重新进入游戏就会直接显示flag了</p>
<p>官方的wp比较简单，通过修改程序执行逻辑使flag可以在程序运行时就显示flag以及相关道具</p>
<h2 id="simpleformat"><a href="#simpleformat" class="headerlink" title="simpleformat"></a>simpleformat</h2><p>就是一个printf输出格式化的问题<br>程序逻辑比较简单：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527900424443.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>需要输入36个字符，主要变换在sub_4006F6函数，然后将数据写入了/dev/null<br>该函数比较恶心，有一大堆的dprintf<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527900566263.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure></p>
<p>分析这一大堆奇怪的字符串，可以发现一些规律：<br>格式基本类似于<code>%1$*2$s</code>，每个函数中字符串的结尾都是<code>%20$n</code><br>首先要知道参数的用法：<br><code>%n</code>指的是向任意地址写入任意值，作用是将之前输出的字符个数写入对应的参数指向的地址<br>printf的<code>$</code>的用法则是指定这个格式串解析的参数偏移量。<code>%2$s</code>即为取出后面的第2个参数，以%s的形式输出。<br>因此<code>%20$n</code>就是将之前输出的字符个数写到第20个参数的地址里。即<strong>unk_627200</strong>用于计数，因此每个dprintf最后第20个参数都是一个int数组中的元素，并且是用于memcmp的比较<br>接下来就是每次写入的字符数量是如何获得的，分析<code>%1$*2$s</code>格式的含义<br><code>*</code>有指定宽度的效果，宽度取自后面的参数，<code>%1$*2$s</code>就是将第一个参数以第二个参数的宽度输出<br>当输出<code>%1$*2$s</code>的串之后，当前输出长度即为第二个参数。继续遇到<code>%1$*2$s</code>则再次输出第二个参数长度，当前输出长度就变成了两倍第二个参数，最后会将输出总长度写入<strong>unk_627200</strong>因此起到了一个求和的效果：<br>n1<em>l1 + n2</em>l3 + …… + n19*l19 = m1<br>······<br>总共18个方程，18元一次方程组<br>大佬的脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">from zio import *</span><br><span class="line">from z3 import *</span><br><span class="line">formats = [] #数据太多太长给删掉了。。。可以自己补</span><br><span class="line">results = [5462280L, 4346506L, 5891159L, 6839864L, 7912833L, 7049790L, 7455784L, 7311612L, 6299256L, 7114100L, 7037043L, 6873051L, 5644794L, 8014197L, 6432215L, 6638450L, 6959905L, 6705884L]</span><br><span class="line">print len(formats)</span><br><span class="line">print len(results)</span><br><span class="line">s = Solver()</span><br><span class="line">d = [BitVec(&quot;d&#123;0&#125;&quot;.format(i), 16) for i in range(18)]</span><br><span class="line">for j in range(len(formats)):</span><br><span class="line">    fmt = formats[j]</span><br><span class="line">    left = 0</span><br><span class="line">    left_str = &apos;&apos;</span><br><span class="line">    for i in range(2, 20):</span><br><span class="line">        c = &apos;%1$*&apos;+str(i)+&apos;$s&apos;</span><br><span class="line"></span><br><span class="line">        left += fmt.count(c)*d[i-2]</span><br><span class="line">        #left_str += str(fmt.count(c))+&apos;*d[&apos;+str(i-2)+&apos;] + &apos;</span><br><span class="line"></span><br><span class="line">    #print left_str</span><br><span class="line">    s.add(left == results[j])</span><br><span class="line"></span><br><span class="line">print s.check()</span><br><span class="line">print s.model()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model = s.model()</span><br><span class="line">init_state = &#123;&#125;</span><br><span class="line">for k in model:</span><br><span class="line">    idx = int(str(k)[1:])</span><br><span class="line">    val = model[k].as_long()</span><br><span class="line">    #print idx, val</span><br><span class="line">    init_state[idx] = val</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = &apos;&apos;</span><br><span class="line">for i in range(18):</span><br><span class="line">    flag += l16(init_state[i])</span><br><span class="line"></span><br><span class="line">print flag</span><br></pre></td></tr></table></figure></p>
<p>注意细节，flag每两位作为了一个数<br>伏地膜</p>
<h2 id="enigma"><a href="#enigma" class="headerlink" title="enigma"></a>enigma</h2><p>即二战时德国所使用的转轮密码机<br>简单查看了密码机的原理，实际上enigma采用复式字母替换加密方法，利用键盘、转子、跳线、反射板、显示器进行对称加密/解密。<br>Enigma属于算法和密钥分离的加密方法，破解Enigma的难度在于不知道当前密钥，包括转子的初始位置和跳线设置。<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527908197009.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527908206823.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure></p>
<p>查找关键函数，根据官方wp，程序实现了转轮机，线性反馈移位寄存器，换位器等<br>输入：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527909005594.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>长度要求是36<br>最后经过比较要相等：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527909263500.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>中间三个处理函数：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527909344106.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure></p>
<p>sub_124F<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527909422356.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527909512441.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>单个取输入字符进行处理，然后写入最后用于比较的outstr</p>
<p>sub_F1E<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527909689435.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527909700557.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure></p>
<p>sub_11F0<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527909809808.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure></p>
<p>因此对于输入的处理都是线性的，有爆破的可能<br>断点下在：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527910679359.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>然后对存储结果处的数据进行比较：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527910745369.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527910774816.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure></p>
<p>这是比较取巧的方法，需要自动调用gdb</p>
<p>出题人的本意是对程序进行生逆，把密文逆成明文。。。<br>也有队伍是这么做的，服：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">with open(&apos;Enigma&apos;, &apos;rb&apos;) as f:</span><br><span class="line">    input_enc = list(f.read()[0x30a0:][:36])</span><br><span class="line"></span><br><span class="line">def bit(a, b):</span><br><span class="line">    return (a &gt;&gt; b) &amp; 1</span><br><span class="line"></span><br><span class="line"># sub_11F0</span><br><span class="line">state = 0x5F3759DF</span><br><span class="line">for i in range(9):</span><br><span class="line">    v16 = bit(state, 0) ^ bit(state, 2) ^ bit(state, 3) ^ bit(state, 5) ^ bit(state, 7) ^ bit(state, 31)</span><br><span class="line">    state = (state &gt;&gt; 1) | (v16 &lt;&lt; 31)</span><br><span class="line">    for j in range(4):</span><br><span class="line">        input_enc[i*4 + j] ^= (state &gt;&gt; (j*8)) &amp; 0xff</span><br><span class="line"></span><br><span class="line"># sub_F1E</span><br><span class="line">def partialRev(c):</span><br><span class="line">    c = bin(c)[2:].rjust(8, &apos;0&apos;)</span><br><span class="line">    c = list(map(int, c))</span><br><span class="line">    r = list(reversed(c))</span><br><span class="line">    c = r[:3] + c[3:5] + r[5:]</span><br><span class="line">    return int(&apos;&apos;.join(map(str, c)), 2)</span><br><span class="line">input_enc = list(map(partialRev, input_enc))</span><br><span class="line"></span><br><span class="line"># sub_124F</span><br><span class="line">wire = [</span><br><span class="line">    [ 0x31, 0x62, 0x93, 0xC4 ],</span><br><span class="line">    [ 0x21, 0x42, 0x63, 0x84 ],</span><br><span class="line">    [ 0x3D, 0x7A, 0xB7, 0xF4 ],</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">def _mix(a1, a2, a3):</span><br><span class="line">    a5 = a3 ^ a2 ^ a1</span><br><span class="line">    a4 = a2 &amp; a1 | a3 &amp; (a2 | a1)</span><br><span class="line">    return (a4, a5)</span><br><span class="line"></span><br><span class="line">def mix(a2, v16, a4):</span><br><span class="line">    bits = []</span><br><span class="line">    for i in range(8):</span><br><span class="line">        v4 = bit(a2, i)</span><br><span class="line">        v5 = bit(v16, i)</span><br><span class="line">        a4, a5 = _mix(v5, v4, a4)</span><br><span class="line">        bits.insert(0, a5)</span><br><span class="line">    return int(&apos;&apos;.join(map(str, bits)), 2), a4</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line">for i, t in enumerate(input_enc):</span><br><span class="line">    for c in range(32, 128):</span><br><span class="line">        a4 = 0</span><br><span class="line">        v16 = c</span><br><span class="line"></span><br><span class="line">        a2 = wire[0][i%4]</span><br><span class="line">        v16, a4 = mix(a2, v16, a4)</span><br><span class="line"></span><br><span class="line">        a2 = wire[1][(i//4%4)]</span><br><span class="line">        v16, a4 = mix(a2, v16, a4)</span><br><span class="line"></span><br><span class="line">        a2 = wire[2][i//16]</span><br><span class="line">        v16, a4 = mix(a2, v16, a4)</span><br><span class="line">        if v16 == t:</span><br><span class="line">            flag.append(c)</span><br><span class="line">            break</span><br><span class="line">print(bytes(flag).decode(&apos;ascii&apos;))</span><br></pre></td></tr></table></figure></p>
<p>首先获取最后结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">with open(&apos;Enigma&apos;, &apos;rb&apos;) as f:</span><br><span class="line">    input_enc = list(f.read()[0x30a0:][:36])</span><br><span class="line"></span><br><span class="line">print(input_enc)</span><br></pre></td></tr></table></figure></p>
<p>然后得到<strong>sub_11F0</strong>异或之前的结果<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527911287081.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>该值是不是可以动态调试得到，内部有好多子函数，没有仔细分析<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">state = 0x5F3759DF</span><br><span class="line">for i in range(9):</span><br><span class="line">    v16 = bit(state, 0) ^ bit(state, 2) ^ bit(state, 3) ^ bit(state, 5) ^ bit(state, 7) ^ bit(state, 31)</span><br><span class="line">    state = (state &gt;&gt; 1) | (v16 &lt;&lt; 31)</span><br><span class="line">    for j in range(4):</span><br><span class="line">        input_enc[i*4 + j] ^= (state &gt;&gt; (j*8)) &amp; 0xff</span><br></pre></td></tr></table></figure></p>
<p>然后是<strong>sub_F1E</strong>的逆向：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527911593518.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def partialRev(c):</span><br><span class="line">    c = bin(c)[2:].rjust(8, &apos;0&apos;)</span><br><span class="line">    c = list(map(int, c))</span><br><span class="line">    r = list(reversed(c))</span><br><span class="line">    c = r[:3] + c[3:5] + r[5:]</span><br><span class="line">    return int(&apos;&apos;.join(map(str, c)), 2)</span><br><span class="line">input_enc = list(map(partialRev, input_enc))</span><br></pre></td></tr></table></figure></p>
<p>也是看起来比较头疼的函数</p>
<p>最后是<strong>sub_124F</strong>，因为比较复杂，采用了正向python模拟实现然后爆破的方式：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="./1527911726618.png" alt="Alt text" title="">
                </div>
                <div class="image-caption">Alt text</div>
            </figure><br>没有勇气看下去。。。。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">wire = [</span><br><span class="line">    [ 0x31, 0x62, 0x93, 0xC4 ],</span><br><span class="line">    [ 0x21, 0x42, 0x63, 0x84 ],</span><br><span class="line">    [ 0x3D, 0x7A, 0xB7, 0xF4 ],</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">def _mix(a1, a2, a3):</span><br><span class="line">    a5 = a3 ^ a2 ^ a1</span><br><span class="line">    a4 = a2 &amp; a1 | a3 &amp; (a2 | a1)</span><br><span class="line">    return (a4, a5)</span><br><span class="line"></span><br><span class="line">def mix(a2, v16, a4):</span><br><span class="line">    bits = []</span><br><span class="line">    for i in range(8):</span><br><span class="line">        v4 = bit(a2, i)</span><br><span class="line">        v5 = bit(v16, i)</span><br><span class="line">        a4, a5 = _mix(v5, v4, a4)</span><br><span class="line">        bits.insert(0, a5)</span><br><span class="line">    return int(&apos;&apos;.join(map(str, bits)), 2), a4</span><br></pre></td></tr></table></figure></p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2018-06-04T13:14:28.992Z" itemprop="dateUpdated">2018-06-04 21:14:28</time>
</span><br>


        
        感谢阅读
        
    </div>
    
    <footer>
        <a href="http://www.w4ter5heep.com">
            <img src="/img/gogo.jpg" alt="W4ter5heep">
            W4ter5heep
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/">CTF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RE/">RE</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/&title=《SUCTF复盘——三个RE》 — W4ter5heep's site&pic=http://www.w4ter5heep.com/img/gogo.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/&title=《SUCTF复盘——三个RE》 — W4ter5heep's site&source=Coding is fun!" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《SUCTF复盘——三个RE》 — W4ter5heep's site&url=http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/&via=http://www.w4ter5heep.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="waves-block waves-effect next">
      <a href="/2018/05/02/StarCTF-BabyDroid/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">StarCTF-BabyDroid</h4>
      </a>
    </div>
  
</nav>



    

















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>W4ter5heep &copy; 2018</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/&title=《SUCTF复盘——三个RE》 — W4ter5heep's site&pic=http://www.w4ter5heep.com/img/gogo.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/&title=《SUCTF复盘——三个RE》 — W4ter5heep's site&source=Coding is fun!" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《SUCTF复盘——三个RE》 — W4ter5heep's site&url=http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/&via=http://www.w4ter5heep.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.w4ter5heep.com/2018/06/04/SUCTF复盘——三个RE/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACv0lEQVR42u3awW7rMAwEwPz/T6dATz1U9pKUnKIYnx5eUlvjg8is+HrF1/v7Sj59/7jyu13/T3LP0YWHh4fXWvrqSh5w/VerO6w+XVGvv79cIR4eHt4x3mS7n1SkBHn9am5WgoeHh/dRXrKJ5yUhaaPx8PDw/gcv+dV/3fhWC0O+Hjw8PLwneUkYUY0eJq+mWpw2ZC14eHh4Ma8XGXz23wfP9/Dw8PAGp+q9Q6lqMaiODhRWi4eHh3eAl7fIOaw3CjAftyr8YsDDw8Mb8yYdaXVbT55SXU9zlAEPDw9vwKseU+WHXr3jsV4zvXw6Hh4e3lZevllXN/dkofOBqptChYeHh3eMlx/bTwYIqgHuJOwoJCJ4eHh4A15yTNUD9BbdG89a/lbAw8PD28TLN9nJEdTkQKuZQOPh4eEd5uUtb691ngS11RA5egV4eHh4A17vdr0XkQQK1aOvZsXDw8PDG/Oq7W81YK0GEznp5uXi4eHhHeD1muPJ4VYSScwHsPDw8PBO8/LhgLw5ngfBvVGG5bPw8PDwNvEKP+xbm3teYHqt/M0QGB4eHt4BXrV1zoPa6lFZ/mlewPDw8PCe4U1unQQTo65/19AVHh4e3oA3Dxd6BWBXmblZFR4eHt4jvF4QkBz/FyKDYkjxmt8CDw8Pb9BSJyMCc3w1RJiEwnh4eHh7eZOlVItBvtBJiIyHh4f3JG9X+5uPZyXBRPK6l3fGw8PDO8DrtcXVslFtl3tDADflBw8PD28T71285kFw9ZBs0tbj4eHhneBVbz1/2K5xhLxo4eHh4Z3gJcUgLxv5X1W39V6rjYeHh3eOV00vqpt4HlVU2+6b7+Dh4eF9lFcNHc4FE4UBLzw8PLw/wOuFvDmmWmxuagEeHh7eMV4vjJgnxAl+VGbw8PDwDvDmWWgvzM1ji+o3N5zv4eHh4f2+ti+Uy7tglw1KigAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '你看不到我了哦！';
            clearTimeout(titleTime);
        } else {
            document.title = '哇，你回来了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
