<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>看雪CTF——ExecuteTable | W4ter5heep&#39;s site</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="CTF,Android">
    <meta name="description" content="看雪CTF——ExecuteTable题目确实比较有难度，自己水平还是太差了，到了so文件的分析，根本不知道关键点在哪里 初步分析首先JEB分析java部分，可以看到有一些混淆，包括对字符串的base64加密等等，但是基本逻辑是可以看到的：主要需要进行两个函数的检测">
<meta name="keywords" content="CTF,Android">
<meta property="og:type" content="article">
<meta property="og:title" content="看雪CTF——ExecuteTable">
<meta property="og:url" content="http://www.w4ter5heep.com/2018/07/03/看雪CTF第五题——ExecuteTable/index.html">
<meta property="og:site_name" content="W4ter5heep&#39;s site">
<meta property="og:description" content="看雪CTF——ExecuteTable题目确实比较有难度，自己水平还是太差了，到了so文件的分析，根本不知道关键点在哪里 初步分析首先JEB分析java部分，可以看到有一些混淆，包括对字符串的base64加密等等，但是基本逻辑是可以看到的：主要需要进行两个函数的检测">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15305835793027.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15305835848924.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15305899110624.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15305901214313.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306217590333.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306186129013.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306210794735.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306208358431.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306208819199.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306209498998.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306238689416.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306207958851.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306250349630.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306256178538.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306261635489.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306581017587.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306582383232.jpg">
<meta property="og:image" content="http://www.w4ter5heep.com/images/15306588811845.jpg">
<meta property="og:updated_time" content="2018-07-03T23:21:44.455Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="看雪CTF——ExecuteTable">
<meta name="twitter:description" content="看雪CTF——ExecuteTable题目确实比较有难度，自己水平还是太差了，到了so文件的分析，根本不知道关键点在哪里 初步分析首先JEB分析java部分，可以看到有一些混淆，包括对字符串的base64加密等等，但是基本逻辑是可以看到的：主要需要进行两个函数的检测">
<meta name="twitter:image" content="http://www.w4ter5heep.com/images/15305835793027.jpg">
    
        <link rel="alternate" type="application/atom+xml" title="W4ter5heep&#39;s site" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu"  >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/gogo.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">W4ter5heep</h5>
          <a href="mailto:w4ter5heep@qq.com" title="w4ter5heep@qq.com" class="mail">w4ter5heep@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/w4ter5heep" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/friendlinks"  >
                <i class="icon icon-lg icon-address-book"></i>
                友链
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">看雪CTF——ExecuteTable</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="global.search_input_hint">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">看雪CTF——ExecuteTable</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-07-03T01:53:04.697Z" itemprop="datePublished" class="page-time">
  2018-07-03
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/WriteUp/">WriteUp</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#看雪CTF——ExecuteTable"><span class="post-toc-number">1.</span> <span class="post-toc-text">看雪CTF——ExecuteTable</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#初步分析"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">初步分析</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#init-proc"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">init_proc</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#初始化函数数组函数-init-array"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">初始化函数数组函数 init_array</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#反调试线程b8bc"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">反调试线程b8bc</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#真正JNI-OnLoad的获取和分析"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">真正JNI_OnLoad的获取和分析</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#check函数lkdakjudajndn"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">check函数lkdakjudajndn</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#花指令"><span class="post-toc-number">1.6.1.</span> <span class="post-toc-text">花指令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#check的主要操作"><span class="post-toc-number">1.6.2.</span> <span class="post-toc-text">check的主要操作</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-看雪CTF第五题——ExecuteTable"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">看雪CTF——ExecuteTable</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-07-03 09:53:04" datetime="2018-07-03T01:53:04.697Z"  itemprop="datePublished">2018-07-03</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/WriteUp/">WriteUp</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="看雪CTF——ExecuteTable"><a href="#看雪CTF——ExecuteTable" class="headerlink" title="看雪CTF——ExecuteTable"></a>看雪CTF——ExecuteTable</h1><p>题目确实比较有难度，自己水平还是太差了，到了so文件的分析，根本不知道关键点在哪里</p>
<h2 id="初步分析"><a href="#初步分析" class="headerlink" title="初步分析"></a>初步分析</h2><p>首先JEB分析java部分，可以看到有一些混淆，包括对字符串的base64加密等等，但是基本逻辑是可以看到的：<br>主要需要进行两个函数的检测<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15305835793027.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>第一个函数：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15305835848924.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>该函数要求输入的字符串中有特殊字符，但是该结果会被第二个函数的结果覆盖，因此并无实际用途</p>
<p>第二个函数为native函数，也是重点需要分析的<br>so函数有诸多陷阱，包括反调试，热修改等等，做出来的方法也是各种骚操作，深深的无力感 = =</p>
<blockquote>
<ol>
<li>so中的反调试，动态库在加载时会创建线程读取<code>/proc/self/status</code>中的<code>TracerPid</code>检测是否被调试</li>
<li>动态库被加载时会读取<code>/proc/self/maps</code>，获得自身基地址，然后通过分析程序头和.dynamic断，修改符号表，改变JNI_Onload地址。</li>
<li>动态库加载时，使用mprotect修改内存权限，使用自修改代码生成新的JNI_OnLoad</li>
<li>实际的解密程序中，有很多花指令和死循环，影响分析</li>
</ol>
</blockquote>
<p>md。。。想放弃</p>
<p>gdb动态调试，可以看到确实存在反调试：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15305899110624.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>断点可以下在JNI_OnLoad，但是该函数是被处理过的，需要解密<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15305901214313.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>可以计算基地址：0xa909ae50-0x8204=0xa9092c4c<br>但是感觉是不正确的.</p>
<h2 id="init-proc"><a href="#init-proc" class="headerlink" title="init_proc"></a>init_proc</h2><p>无实际用途<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306217590333.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<h2 id="初始化函数数组函数-init-array"><a href="#初始化函数数组函数-init-array" class="headerlink" title="初始化函数数组函数 init_array"></a>初始化函数数组函数 init_array</h2><p>找到so文件的0x34CD0位置，根据wp，可以知道是函数的初始化数组（wp似乎是通过修复so的section段发现的？不懂的操作）：<br>可以通过readelf查看so文件的动态段得到init_array的地址<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306186129013.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>init_array先于JNI_OnLoad运行，上面的函数中应该存在对JNI_OnLoad的解密</p>
<ul>
<li>sub_67bc ———— 创建反调试线程b8bc<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306210794735.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306208358431.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306208819199.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306209498998.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
可以看到这部分利用v8新开辟的0x20空间注册了函数<br>某wp修复后的：<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306238689416.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
</ul>
<p>有几个函数比较关键：<strong>pthread_create</strong>，<strong>mprotect</strong>与<strong>__NR_openat</strong><br>应该下断点绕过反调试后进行分析的。。。但是不太会下断点</p>
<p>__NR_openat打开过/proc/self/maps与/proc/self/status, 而mprotect有修改JNI_OnLoad偏移与代码解密操作<br>wp的推测：打开/proc/self/maps是为了拿到基址，/proc/self/status/是反调试, 后面实际解key时感觉应该是检测到调试，就把解密中需要用到的一个全局变量修改掉。导致得到错误的结果。<br><strong>mprotect</strong>调用了两次，第一次修改JNI_OnLoad的偏移，由0x8205修改为<strong>0xA260</strong> ,这也就是真正的JNI_OnLoad函数，在这个函数中可以看到JNIEnv的FindClass与RegisterNatives，所以可以拿到验证key的native函数地址0xAC98<br>直接去到0xAC98发现代码无法解析，应该是加密了。</p>
<p>所以<strong>第二次mprotect调用</strong>就是解密0xAC98中被加密的代码。</p>
<h2 id="反调试线程b8bc"><a href="#反调试线程b8bc" class="headerlink" title="反调试线程b8bc"></a>反调试线程b8bc</h2><p>sub_67bc下面用到的函数即是pthread_create，创建反调试线程<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306207958851.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>反调试部分的代码没有直接被ida识别为函数，可以create function得到<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306250349630.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>反调试的骚操作如下(中间有各种垃圾代码）：</p>
<ol>
<li>解密字符串“tracePid”。</li>
<li>解密字符串“%*s%d”。</li>
<li>解密字符串“/proc/self/status”。</li>
<li>打开文件 “/proc/self/status”，一行一行读取，一直找到 “tracePid”为止。</li>
<li>调用scanf获取tracePid的数值。</li>
<li>如果 tracePid &gt; 0, 则全局变量0x36098 = 0xBD9813BA，否则  0x36098 = 0x2333AE83。</li>
<li>线程sleep 5秒。</li>
</ol>
<p>过掉反调试： 0x36098 的值在对输入key进行变换时有用到，当程序处于调试状态时，会使key计算出错。过掉反调试方法很多，但是无论用啥方法必须要使0x36098 赋值为 0x2333AE83 。可以让线程进入死循环，或者让线程终止，或者让线程sleep(100000)秒，也可以直接修改逻辑让tracePid恒等于0。</p>
<h2 id="真正JNI-OnLoad的获取和分析"><a href="#真正JNI-OnLoad的获取和分析" class="headerlink" title="真正JNI_OnLoad的获取和分析"></a>真正JNI_OnLoad的获取和分析</h2><p>方法一：此函数不能直接下断点，否则可能会使代码解密失败，可以直接在<strong>libdvm</strong>中下断点。这个函数主要作用是<strong>动态注册native lkdakjudajndn函数</strong> 从这里可知 lkdakjudajndn函数地址为：<strong>AC98</strong>。这个函数是真正的key校验过程。<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306256178538.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>真正的JNI_OnLoad，没有代码的自解密，只是hook了地址，还比较友好<br>可以查找注册<strong>lkdakjudajndn</strong>的位置：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306261635489.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>并不知道是怎么计算得到函数lkdakjudajndn地址是0xAC98的，动态调试直接看？</p>
<h2 id="check函数lkdakjudajndn"><a href="#check函数lkdakjudajndn" class="headerlink" title="check函数lkdakjudajndn"></a>check函数lkdakjudajndn</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306581017587.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>这部分代码是需要动态解密的，具体方法是调用mprotect进行解密，解密函数是sub_833c<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306582383232.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>函数混淆的也比较烦，很难分析，解密代码的主要部分<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/15306588811845.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>解密后的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br></pre></td><td class="code"><pre><span class="line">char *__fastcall lkdakjudajndn(struct _JNIEnv *a1)</span><br><span class="line">&#123;</span><br><span class="line">  char *inputKey; // r0</span><br><span class="line">  char *v2; // r4</span><br><span class="line">  unsigned int i; // r4</span><br><span class="line">  int v4; // r2</span><br><span class="line">  int v5; // r3</span><br><span class="line">  char v6; // r6</span><br><span class="line">  unsigned int j; // r4</span><br><span class="line">  int v8; // r2</span><br><span class="line">  int v9; // r3</span><br><span class="line">  char *v10; // r6</span><br><span class="line">  int v11; // r8</span><br><span class="line">  int v12; // r2</span><br><span class="line">  int v13; // r3</span><br><span class="line">  signed int v14; // r10</span><br><span class="line">  unsigned int v15; // r7</span><br><span class="line">  char v16; // r8</span><br><span class="line">  unsigned int keylen; // r2</span><br><span class="line">  int v18; // r2</span><br><span class="line">  int v19; // r3</span><br><span class="line">  int v20; // r2</span><br><span class="line">  int v21; // r3</span><br><span class="line">  unsigned int v22; // r7</span><br><span class="line">  unsigned int v23; // r8</span><br><span class="line">  int string_A3Cw6Gb0OZWPU52s_1; // ST10_4</span><br><span class="line">  int v25; // ST10_4</span><br><span class="line">  int lowkeyChar; // ST10_4</span><br><span class="line">  unsigned int string_3d8ahnb1_1; // r6</span><br><span class="line">  int v28; // r2</span><br><span class="line">  int v29; // r3</span><br><span class="line">  const char *v30; // r1</span><br><span class="line">  int v31; // r2</span><br><span class="line">  int v32; // r3</span><br><span class="line">  int v33; // r2</span><br><span class="line">  int v34; // r3</span><br><span class="line">  int v35; // r2</span><br><span class="line">  int v36; // r3</span><br><span class="line">  int *v37; // r0</span><br><span class="line">  int inputKeyString; // [sp+20h] [bp-6B8h]</span><br><span class="line">  int newInputKeyBuf; // [sp+24h] [bp-6B4h]</span><br><span class="line">  int inputKeyBuf; // [sp+28h] [bp-6B0h]</span><br><span class="line">  int buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW; // [sp+2Ch] [bp-6ACh]</span><br><span class="line">  _BYTE *string_3d8ahnb1_is_U8; // [sp+30h] [bp-6A8h]</span><br><span class="line">  char buf_U8; // [sp+34h] [bp-6A4h]</span><br><span class="line">  char string_3; // [sp+38h] [bp-6A0h]</span><br><span class="line">  char buf_3w; // [sp+3Ch] [bp-69Ch]</span><br><span class="line">  char buf_3ww; // [sp+40h] [bp-698h]</span><br><span class="line">  char string_aA782e192b81nic; // [sp+44h] [bp-694h]</span><br><span class="line">  char v49; // [sp+48h] [bp-690h]</span><br><span class="line">  int string_A3Cw6Gb0OZWPU52s; // [sp+4Ch] [bp-68Ch]</span><br><span class="line">  int string_0; // [sp+50h] [bp-688h]</span><br><span class="line">  int string_0_1; // [sp+54h] [bp-684h]</span><br><span class="line">  int v53; // [sp+58h] [bp-680h]</span><br><span class="line">  char v54; // [sp+5Ch] [bp-67Ch]</span><br><span class="line">  int newstring_BQ366EYdQs_1; // [sp+60h] [bp-678h]</span><br><span class="line">  char buf_44678; // [sp+64h] [bp-674h]</span><br><span class="line">  int string_A782E192B81NICAIsan38Qz; // [sp+68h] [bp-670h]</span><br><span class="line">  char string_3373080; // [sp+6Ch] [bp-66Ch]</span><br><span class="line">  int newstring_BQ366EYdQs; // [sp+70h] [bp-668h]</span><br><span class="line">  char buf_29285; // [sp+74h] [bp-664h]</span><br><span class="line">  char *v61; // [sp+78h] [bp-660h]</span><br><span class="line">  char v62; // [sp+7Ch] [bp-65Ch]</span><br><span class="line">  char string_BQ366EYdQs_1; // [sp+80h] [bp-658h]</span><br><span class="line">  char string_BQ366EYdQs; // [sp+84h] [bp-654h]</span><br><span class="line">  char newintputKey_buf; // [sp+88h] [bp-650h]</span><br><span class="line">  char v66; // [sp+8Ch] [bp-64Ch]</span><br><span class="line">  char v67; // [sp+90h] [bp-648h]</span><br><span class="line">  int v68; // [sp+94h] [bp-644h]</span><br><span class="line">  char v69; // [sp+98h] [bp-640h]</span><br><span class="line">  char v70; // [sp+9Ch] [bp-63Ch]</span><br><span class="line">  char input_KeyBuffer_location0; // [sp+A0h] [bp-638h]</span><br><span class="line">  int inputKeyBuf_location1; // [sp+A4h] [bp-634h]</span><br><span class="line">  char inputKeyBuf_last1; // [sp+A8h] [bp-630h]</span><br><span class="line">  int string_UYetrq736UMayFindMe233; // [sp+ACh] [bp-62Ch]</span><br><span class="line">  char buf_3d8ahnb1; // [sp+B0h] [bp-628h]</span><br><span class="line">  char string_U8; // [sp+B4h] [bp-624h]</span><br><span class="line">  char string_D; // [sp+B8h] [bp-620h]</span><br><span class="line">  int buf_BQ366EYdQs3716UCANDOIT666; // [sp+BCh] [bp-61Ch]</span><br><span class="line">  char string_0_2; // [sp+C0h] [bp-618h]</span><br><span class="line">  char buf_BQ366EYdQs; // [sp+C4h] [bp-614h]</span><br><span class="line">  int v81; // [sp+C8h] [bp-610h]</span><br><span class="line">  char v82; // [sp+CCh] [bp-60Ch]</span><br><span class="line">  char unknowStruct1; // [sp+D0h] [bp-608h]</span><br><span class="line">  char string_1; // [sp+D8h] [bp-600h]</span><br><span class="line">  int v85; // [sp+DCh] [bp-5FCh]</span><br><span class="line">  char v86; // [sp+18Ch] [bp-54Ch]</span><br><span class="line">  int v87; // [sp+194h] [bp-544h]</span><br><span class="line">  char v88; // [sp+198h] [bp-540h]</span><br><span class="line">  char v89; // [sp+248h] [bp-490h]</span><br><span class="line">  char v90; // [sp+250h] [bp-488h]</span><br><span class="line">  int v91; // [sp+254h] [bp-484h]</span><br><span class="line">  char v92; // [sp+304h] [bp-3D4h]</span><br><span class="line">  char v93; // [sp+30Ch] [bp-3CCh]</span><br><span class="line">  char v94; // [sp+310h] [bp-3C8h]</span><br><span class="line">  char v95; // [sp+3C0h] [bp-318h]</span><br><span class="line">  char v96; // [sp+3C8h] [bp-310h]</span><br><span class="line">  char v97; // [sp+3CCh] [bp-30Ch]</span><br><span class="line">  char v98; // [sp+47Ch] [bp-25Ch]</span><br><span class="line">  char v99; // [sp+484h] [bp-254h]</span><br><span class="line">  char v100; // [sp+488h] [bp-250h]</span><br><span class="line">  char buf_33687; // [sp+538h] [bp-1A0h]</span><br><span class="line">  char v102; // [sp+540h] [bp-198h]</span><br><span class="line">  char v103; // [sp+544h] [bp-194h]</span><br><span class="line">  char string_DU8NABvA; // [sp+5F4h] [bp-E4h]</span><br><span class="line">  int string_33687_0; // [sp+5FCh] [bp-DCh]</span><br><span class="line">  int v106; // [sp+600h] [bp-D8h]</span><br><span class="line"> </span><br><span class="line">  inputKey = (char *)(*(int (**)(void))(*(_DWORD *)a1 + 676))();</span><br><span class="line">  newString1(&amp;inputKeyString, (int)inputKey);</span><br><span class="line">  newString1(&amp;string_aA782e192b81nic, (int)&quot;A782E192B81NICAIsan38Qz&quot;);</span><br><span class="line">  CreateUnknowStructFunc((int)&amp;unknowStruct1, 24);</span><br><span class="line">  hextoString((int)&amp;string_1, 1);</span><br><span class="line">  sub_DD44(&amp;v49, &amp;v85);</span><br><span class="line">  v2 = (_BYTE *)(&amp;stru_908 + 10);</span><br><span class="line">  if ( !std::operator==&lt;char&gt;(&amp;string_aA782e192b81nic, &amp;v49) )</span><br><span class="line">    v2 = (_BYTE *)(&amp;dword_0 + 1);</span><br><span class="line">  if ( std::operator!=&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;v49, &amp;string_aA782e192b81nic) )</span><br><span class="line">  &#123;</span><br><span class="line">    CreateUnknowStructFunc((int)&amp;string_DU8NABvA, 24);</span><br><span class="line">    hextoString((int)&amp;string_33687_0, 33687);</span><br><span class="line">    sub_DD44(&amp;buf_33687, &amp;v106);</span><br><span class="line">    v2 = (char *)std::operator==&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;buf_33687, &quot;0d87a&quot;);</span><br><span class="line">    deleteString(&amp;buf_33687);</span><br><span class="line">    sub_DBAC(&amp;string_DU8NABvA);</span><br><span class="line">  &#125;</span><br><span class="line">  if ( v2 == (_BYTE *)&amp;dword_0 + 1 )</span><br><span class="line">    v2 = (char *)off_35CFC + 303183;</span><br><span class="line">  deleteString(&amp;v49);</span><br><span class="line">  sub_DBAC(&amp;unknowStruct1);</span><br><span class="line">  deleteString(&amp;string_aA782e192b81nic);</span><br><span class="line">  if ( (unsigned int)(*(_DWORD *)(inputKeyString - 12) - 0xA) &lt;= 0xA )// key长度要小于等于20</span><br><span class="line">  &#123;</span><br><span class="line">    GetStringBuf(&amp;inputKeyBuf, &amp;inputKeyString);// inputKeyBuf = C0ngRa7U1AtIoN2U</span><br><span class="line">    newString1(&amp;newInputKeyBuf, (int)&amp;unk_30735);</span><br><span class="line">    copyStringFromLocation((int)&amp;inputKeyBuf_location1, &amp;inputKeyBuf, 1u, *(_DWORD *)(inputKeyBuf - 12));</span><br><span class="line">    copyStringFromLocation((int)&amp;input_KeyBuffer_location0, &amp;inputKeyBuf, 0, 1u);</span><br><span class="line">    stringStrCat(&amp;inputKeyBuf_last1, &amp;inputKeyBuf_location1, (int)&amp;input_KeyBuffer_location0);// 将第一个字符放到最后一个位置上</span><br><span class="line">    StringChange((int)&amp;inputKeyBuf, (int)&amp;inputKeyBuf_last1);// inputKeyBuf=inputKeyBuf_last1</span><br><span class="line">    deleteString(&amp;inputKeyBuf_last1);</span><br><span class="line">    deleteString(&amp;input_KeyBuffer_location0);</span><br><span class="line">    deleteString(&amp;inputKeyBuf_location1);       // inputKeyBuf = 0ngRa7U1AtIoN2UC</span><br><span class="line">    for ( i = 0; i &lt; *(_DWORD *)(inputKeyBuf - 12); ++i )// 根据输入的key进行从字典中索引然后创建新的字符串</span><br><span class="line">      CreateStringByChar(&amp;newInputKeyBuf, *((_BYTE *)off_35CF8 + *(unsigned __int8 *)(inputKeyBuf + i) + 0x21));</span><br><span class="line">    StringChange((int)&amp;inputKeyBuf, (int)&amp;newInputKeyBuf);// 此时 inputKeyBuf变成新的了</span><br><span class="line">    SetStringNull((int)&amp;newInputKeyBuf, (int)&amp;unk_30735, v4, v5);// 此时81 bb b1 70 c9 d8 64 41 ad 4f c4 bd e2 19 64 11</span><br><span class="line">    newString1(&amp;newstring_BQ366EYdQs, (int)&quot;BQ366EYdQs3716UCANDOIT666&quot;);</span><br><span class="line">    CreateUnknowStructFunc((int)&amp;v95, 24);</span><br><span class="line">    hextoString((int)&amp;v96, 29285);</span><br><span class="line">    sub_DD44(&amp;buf_29285, &amp;v97);</span><br><span class="line">    copyStringFromLocation((int)&amp;string_BQ366EYdQs, &amp;newstring_BQ366EYdQs, 0, 0xAu);</span><br><span class="line">    StringChange((int)&amp;newstring_BQ366EYdQs, (int)&amp;string_BQ366EYdQs);// 变成10个了</span><br><span class="line">    deleteString(&amp;string_BQ366EYdQs);</span><br><span class="line">    if ( std::operator==&lt;char&gt;(&amp;newstring_BQ366EYdQs, &amp;buf_29285) )</span><br><span class="line">      v6 = 50;</span><br><span class="line">    else</span><br><span class="line">      v6 = 1;</span><br><span class="line">    deleteString(&amp;buf_29285);</span><br><span class="line">    sub_DBAC(&amp;v95);</span><br><span class="line">    deleteString(&amp;newstring_BQ366EYdQs);</span><br><span class="line">    for ( j = 0; j &lt; *(_DWORD *)(inputKeyBuf - 12); ++j )</span><br><span class="line">      CreateStringByChar(                       // 进行低4位和高位的切换，并且创建新的string</span><br><span class="line">        &amp;newInputKeyBuf,</span><br><span class="line">        ((*(_BYTE *)(inputKeyBuf + j) &amp; 0xF) &lt;&lt; 4 * v6) | (*(_BYTE *)(inputKeyBuf + j) &gt;&gt; 4));</span><br><span class="line">    StringChange((int)&amp;inputKeyBuf, (int)&amp;newInputKeyBuf);// 此时inputKey每个字节的低4位和高4位进行切换了</span><br><span class="line">                                                // 此时18 bb 1b 07 9c 8d 46 14 da f4 4c db 2e 91 46 11</span><br><span class="line">    SetStringNull((int)&amp;newInputKeyBuf, (int)&amp;unk_30735, v8, v9);</span><br><span class="line">    newString1(&amp;string_A782E192B81NICAIsan38Qz, (int)&quot;A782E192B81NICAIsan38Qz&quot;);</span><br><span class="line">    CreateUnknowStructFunc((int)&amp;v92, 24);</span><br><span class="line">    hextoString((int)&amp;v93, 3373080);</span><br><span class="line">    sub_DD44(&amp;string_3373080, &amp;v94);</span><br><span class="line">    v10 = (char *)3373029;</span><br><span class="line">    if ( !std::operator==&lt;char&gt;(&amp;string_A782E192B81NICAIsan38Qz, &amp;string_3373080) )</span><br><span class="line">      v10 = (char *)3373080;</span><br><span class="line">    if ( std::operator!=&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(</span><br><span class="line">           &amp;string_3373080,</span><br><span class="line">           &amp;string_A782E192B81NICAIsan38Qz) )</span><br><span class="line">    &#123;</span><br><span class="line">      CreateUnknowStructFunc((int)&amp;string_DU8NABvA, 24);</span><br><span class="line">      hextoString((int)&amp;string_33687_0, 33687);</span><br><span class="line">      sub_DD44(&amp;buf_33687, &amp;v106);</span><br><span class="line">      v10 = (char *)std::operator==&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;buf_33687, &quot;0d87a&quot;);</span><br><span class="line">      deleteString(&amp;buf_33687);</span><br><span class="line">      sub_DBAC(&amp;string_DU8NABvA);</span><br><span class="line">      if ( v10 )</span><br><span class="line">        v10 = (char *)off_35CFC + 0x4A04F;</span><br><span class="line">    &#125;</span><br><span class="line">    deleteString(&amp;string_3373080);</span><br><span class="line">    sub_DBAC(&amp;v92);</span><br><span class="line">    deleteString(&amp;string_A782E192B81NICAIsan38Qz);// 对输入的key4字节与 DA78DE8A进行亦或</span><br><span class="line">    v11 = 0;</span><br><span class="line">    do                                          // 0x36090</span><br><span class="line">    &#123;                                           // </span><br><span class="line">                                                // 36098 = DA78DE8A</span><br><span class="line">      CreateStringByChar(&amp;newInputKeyBuf, v10[inputKeyBuf + v11] ^ dword_36098);</span><br><span class="line">      CreateStringByChar(&amp;newInputKeyBuf, BYTE1(dword_36098) ^ *(_BYTE *)(inputKeyBuf + v11 + 1));</span><br><span class="line">      CreateStringByChar(&amp;newInputKeyBuf, BYTE2(dword_36098) ^ *(_BYTE *)(inputKeyBuf + v11 + 2));</span><br><span class="line">      CreateStringByChar(&amp;newInputKeyBuf, *(_BYTE *)(inputKeyBuf + v11 + 3) ^ HIBYTE(dword_36098));</span><br><span class="line">      v11 += 4;</span><br><span class="line">    &#125;</span><br><span class="line">    while ( v11 != 0x10 );                      // 证明输入的key为16个字节</span><br><span class="line">    StringChange((int)&amp;inputKeyBuf, (int)&amp;newInputKeyBuf);</span><br><span class="line">    SetStringNull((int)&amp;newInputKeyBuf, (int)&amp;unk_30735, v12, v13);</span><br><span class="line">    newString1(&amp;newstring_BQ366EYdQs_1, (int)&quot;BQ366EYdQs3716UCANDOIT666&quot;);</span><br><span class="line">    CreateUnknowStructFunc((int)&amp;v89, 24);</span><br><span class="line">    hextoString((int)&amp;v90, 44678);</span><br><span class="line">    sub_DD44(&amp;buf_44678, &amp;v91);</span><br><span class="line">    copyStringFromLocation((int)&amp;string_BQ366EYdQs_1, &amp;newstring_BQ366EYdQs_1, 0, 0xAu);</span><br><span class="line">    StringChange((int)&amp;newstring_BQ366EYdQs_1, (int)&amp;string_BQ366EYdQs_1);</span><br><span class="line">    deleteString(&amp;string_BQ366EYdQs_1);</span><br><span class="line">    if ( std::operator==&lt;char&gt;(&amp;newstring_BQ366EYdQs_1, &amp;buf_44678) )</span><br><span class="line">      v14 = 50;</span><br><span class="line">    else</span><br><span class="line">      v14 = 1;</span><br><span class="line">    deleteString(&amp;buf_44678);</span><br><span class="line">    sub_DBAC(&amp;v89);</span><br><span class="line">    v15 = 0;</span><br><span class="line">    deleteString(&amp;newstring_BQ366EYdQs_1);      // 此时key =9b 15 28 24 1f 23 75 37 59 5a 7f f8 ad 3f 75 32</span><br><span class="line">    while ( 1 )</span><br><span class="line">    &#123;                                           // 对输入key进行相邻字节交换</span><br><span class="line">      keylen = *(_DWORD *)(inputKeyBuf - 12);</span><br><span class="line">      if ( v15 &gt;= keylen &gt;&gt; 1 )</span><br><span class="line">        break;</span><br><span class="line">      v16 = *(_BYTE *)(inputKeyBuf + 2 * v15);</span><br><span class="line">      CreateStringByChar(&amp;newInputKeyBuf, *(_BYTE *)(inputKeyBuf + v14 + 2 * v15));</span><br><span class="line">      CreateStringByChar(&amp;newInputKeyBuf, v16);</span><br><span class="line">      ++v15;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( keylen &amp; 1 )</span><br><span class="line">    &#123;</span><br><span class="line">      copyStringFromLocation((int)&amp;v70, &amp;inputKeyBuf, keylen - 1, 1u);</span><br><span class="line">      copyString((int)&amp;newInputKeyBuf, (int)&amp;v70);</span><br><span class="line">      deleteString(&amp;v70);</span><br><span class="line">    &#125;</span><br><span class="line">    StringChange((int)&amp;inputKeyBuf, (int)&amp;newInputKeyBuf);// 此时key进行了相邻字节交换</span><br><span class="line">                                                // 此时15 9b 24 28 23 1f 37 75 5a 59 f8 7f 3f ad 32 75</span><br><span class="line">                                                // </span><br><span class="line">    SetStringNull((int)&amp;newInputKeyBuf, (int)&amp;unk_30735, v18, v19);</span><br><span class="line">    while ( (unsigned int)v10 &lt; *(_DWORD *)(inputKeyBuf - 12) )// 再次对字典7FC2开始索引</span><br><span class="line">      CreateStringByChar(&amp;newInputKeyBuf, *((_BYTE *)off_35CF8 + (unsigned __int8)(v10++)[inputKeyBuf] + 33));</span><br><span class="line">    StringChange((int)&amp;inputKeyBuf, (int)&amp;newInputKeyBuf);// inputKeyBuf= 33 1a 3c 38 1e c7 d8 1b 37 83 05 a5 54 1d 19 1b</span><br><span class="line">    SetStringNull((int)&amp;newInputKeyBuf, (int)&amp;unk_30735, v20, v21);</span><br><span class="line">    newString1(&amp;v53, (int)&quot;BQ366EYdQs3716UCANDOIT666&quot;);</span><br><span class="line">    CreateUnknowStructFunc((int)&amp;v86, 24);</span><br><span class="line">    hextoString((int)&amp;v87, 154634026);</span><br><span class="line">    sub_DD44(&amp;v54, &amp;v88);</span><br><span class="line">    copyStringFromLocation((int)&amp;v62, &amp;v53, 0, 0xAu);</span><br><span class="line">    StringChange((int)&amp;v53, (int)&amp;v62);</span><br><span class="line">    deleteString(&amp;v62);</span><br><span class="line">    if ( std::operator==&lt;char&gt;(&amp;v53, &amp;v54) )</span><br><span class="line">      v22 = 50;</span><br><span class="line">    else</span><br><span class="line">      v22 = 1;                                  // v22=1</span><br><span class="line">    deleteString(&amp;v54);</span><br><span class="line">    sub_DBAC(&amp;v86);</span><br><span class="line">    deleteString(&amp;v53);</span><br><span class="line">    copyStringFromLocation((int)&amp;v68, &amp;inputKeyBuf, v22, *(_DWORD *)(inputKeyBuf - 12));</span><br><span class="line">    copyStringFromLocation((int)&amp;v67, &amp;inputKeyBuf, 0, v22);</span><br><span class="line">    stringStrCat(&amp;v69, &amp;v68, (int)&amp;v67);</span><br><span class="line">    StringChange((int)&amp;newInputKeyBuf, (int)&amp;v69);// 此时 newintputKey_buf 第一个字节被置换到最后一个字节</span><br><span class="line">                                                //  1a 3c 38 1e c7 d8 1b 37 83 05 a5 54 1d 19 1b 33</span><br><span class="line"> </span><br><span class="line">    deleteString(&amp;v69);</span><br><span class="line">    deleteString(&amp;v67);</span><br><span class="line">    deleteString(&amp;v68);</span><br><span class="line">    GetStringBuf(&amp;newintputKey_buf, &amp;newInputKeyBuf);</span><br><span class="line">    newString1(&amp;string_A3Cw6Gb0OZWPU52s, (int)&quot;A3Cw6Gb0OZWPU52s&quot;);</span><br><span class="line">    newString1(&amp;string_0, (int)&amp;unk_30735);</span><br><span class="line">    newString1(&amp;string_0_1, (int)&amp;unk_30735);</span><br><span class="line">    v23 = 0;</span><br><span class="line">    while ( v23 &lt; *(_DWORD *)(*(_DWORD *)&amp;newintputKey_buf - 12) )// 此时 newintputKey_buf = 13 3b 39 1d c4 d5 15 33 87 0b a8 57 1e 18 1c 3a</span><br><span class="line">    &#123;                                           // string_0放A3Cw6Gb0OZWPU52s按照高4位索引的string</span><br><span class="line">                                                // string_1放A3Cw6Gb0OZWPU52s按照低位索引的string</span><br><span class="line">      string_A3Cw6Gb0OZWPU52s_1 = string_A3Cw6Gb0OZWPU52s;</span><br><span class="line">      sub_191A8(&amp;newintputKey_buf);</span><br><span class="line">      CreateStringByChar(                       // 将输入key按字节/16 然后从A3Cw6Gb0OZWPU52s中按照索引获取</span><br><span class="line">        &amp;string_0,</span><br><span class="line">        *(_BYTE *)(string_A3Cw6Gb0OZWPU52s_1</span><br><span class="line">                 + ((unsigned int)*(unsigned __int8 *)(*(_DWORD *)&amp;newintputKey_buf + v23) &gt;&gt; 4)));</span><br><span class="line">      v25 = string_A3Cw6Gb0OZWPU52s;</span><br><span class="line">      sub_191A8(&amp;newintputKey_buf);</span><br><span class="line">      lowkeyChar = *(unsigned __int8 *)(v25 + (*(_BYTE *)(*(_DWORD *)&amp;newintputKey_buf + v23) &amp; 0xF));// 然后字节&amp;0xF 再从A3Cw6Gb0OZWPU52s中索引</span><br><span class="line">      v61 = (char *)off_35D04 + 12;</span><br><span class="line">      createStringByLen((int *)&amp;v61, *(_DWORD *)(string_0_1 - 12) + 1);</span><br><span class="line">      sub_19520((int *)&amp;v61, 1u, lowkeyChar);</span><br><span class="line">      sub_193C4((int *)&amp;v61, (_BYTE **)&amp;string_0_1);</span><br><span class="line">      StringChange((int)&amp;string_0_1, (int)&amp;v61);</span><br><span class="line">      ++v23;</span><br><span class="line">      deleteString(&amp;v61);</span><br><span class="line">    &#125;</span><br><span class="line">    stringStrCat(&amp;v66, &amp;string_0, (int)&amp;string_0_1);// 高位4位与第4位分别索引获取的子串</span><br><span class="line">                                                // 3ww3U53wOAWG333wWUO20OP0wGG65ZPw</span><br><span class="line">                                                // </span><br><span class="line">                                                // 这个应该是真实的</span><br><span class="line">                                                // 3ww3U53wOAWG333wwPZ56GGw0PO02OUW</span><br><span class="line">                                                // 3ww3U53wOAWG333wwPZ56GGw0PO02OUW</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    deleteString(&amp;string_0_1);</span><br><span class="line">    deleteString(&amp;string_0);</span><br><span class="line">    deleteString(&amp;string_A3Cw6Gb0OZWPU52s);</span><br><span class="line">    StringChange((int)&amp;newInputKeyBuf, (int)&amp;v66);// inputkey变成了高位索引和低位索引的string了</span><br><span class="line">    deleteString(&amp;v66);</span><br><span class="line">    deleteString(&amp;newintputKey_buf);</span><br><span class="line">    deleteString(&amp;inputKeyBuf);</span><br><span class="line">    newString1(&amp;string_3d8ahnb1_is_U8, (int)&quot;3d8ahnb1&quot;);</span><br><span class="line">    newString1(&amp;string_UYetrq736UMayFindMe233, (int)&quot;UYetrq736UMayFindMe233&quot;);</span><br><span class="line">    CreateUnknowStructFunc((int)&amp;v98, 24);</span><br><span class="line">    sub_F0A4((int)&amp;v99, &amp;string_3d8ahnb1_is_U8);</span><br><span class="line">    sub_DD44(&amp;buf_3d8ahnb1, &amp;v100);</span><br><span class="line">    sub_191A8(&amp;string_3d8ahnb1_is_U8);</span><br><span class="line">    string_3d8ahnb1_1 = (unsigned __int8)*string_3d8ahnb1_is_U8;</span><br><span class="line">    if ( std::operator==&lt;char&gt;(&amp;string_UYetrq736UMayFindMe233, &amp;buf_3d8ahnb1) )// 不等</span><br><span class="line">    &#123;</span><br><span class="line">      newString1(&amp;string_DU8NABvA, (int)&quot;DABD786ABH&quot;);</span><br><span class="line">      if ( string_3d8ahnb1_1 == 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v30 = &quot;8a7d9Vduya&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">      else if ( string_3d8ahnb1_1 &gt;= 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        if ( string_3d8ahnb1_1 == 2 )</span><br><span class="line">          v30 = &quot;73812huvVQ&quot;;</span><br><span class="line">        else</span><br><span class="line">          v30 = &quot;daj87YBDASYBvy&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">        v30 = &quot;UDHA47DBsd&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">      SetStringNull((int)&amp;string_3d8ahnb1_is_U8, (int)v30, v28, v29);</span><br><span class="line">      copyString((int)&amp;string_3d8ahnb1_is_U8, (int)&amp;string_DU8NABvA);</span><br><span class="line">      deleteString(&amp;string_DU8NABvA);</span><br><span class="line">    &#125;</span><br><span class="line">    if ( std::operator!=&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(</span><br><span class="line">           &amp;string_UYetrq736UMayFindMe233,</span><br><span class="line">           &amp;buf_3d8ahnb1) )</span><br><span class="line">    &#123;</span><br><span class="line">      SetStringNull((int)&amp;string_3d8ahnb1_is_U8, (int)&amp;unk_30735, v31, v32);// 进来</span><br><span class="line">      newString1(&amp;string_DU8NABvA, (int)&quot;DU8NABvA&quot;);</span><br><span class="line">      copyStringFromLocation((int)&amp;string_D, &amp;string_DU8NABvA, 0, 1u);</span><br><span class="line">      copyString((int)&amp;string_3d8ahnb1_is_U8, (int)&amp;string_D);</span><br><span class="line">      deleteString(&amp;string_D);</span><br><span class="line">      if ( std::operator!=&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;string_3d8ahnb1_is_U8, &amp;unk_30735) )</span><br><span class="line">        SetStringNull((int)&amp;string_3d8ahnb1_is_U8, (int)&amp;unk_30735, v33, v34);// 又变成空了</span><br><span class="line">      copyStringFromLocation((int)&amp;string_U8, &amp;string_DU8NABvA, 1u, 2u);</span><br><span class="line">      copyString((int)&amp;string_3d8ahnb1_is_U8, (int)&amp;string_U8);// 又变成U8了</span><br><span class="line">      deleteString(&amp;string_U8);</span><br><span class="line">      if ( std::operator!=&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;string_3d8ahnb1_is_U8, &amp;unk_30735) )</span><br><span class="line">        SetStringNull((int)&amp;string_3d8ahnb1_is_U8, (int)&amp;unk_30735, v35, v36);// 又设置成空了</span><br><span class="line">      deleteString(&amp;string_DU8NABvA);</span><br><span class="line">    &#125;</span><br><span class="line">    GetStringBuf(&amp;buf_U8, (int *)&amp;string_3d8ahnb1_is_U8);// 到这里了</span><br><span class="line">    deleteString(&amp;buf_3d8ahnb1);</span><br><span class="line">    sub_DBAC(&amp;v98);</span><br><span class="line">    deleteString(&amp;string_UYetrq736UMayFindMe233);</span><br><span class="line">    std::operator+&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;string_3, &amp;buf_U8, &apos;3&apos;);</span><br><span class="line">    std::operator+&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;buf_3w, &amp;string_3, &apos;w&apos;);</span><br><span class="line">    std::operator+&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;buf_3ww, &amp;buf_3w, &apos;w&apos;);</span><br><span class="line">    std::operator+&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(</span><br><span class="line">      &amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW,</span><br><span class="line">      &amp;buf_3ww,</span><br><span class="line">      &apos;3&apos;);</span><br><span class="line">    deleteString(&amp;buf_3ww);</span><br><span class="line">    deleteString(&amp;buf_3w);</span><br><span class="line">    deleteString(&amp;string_3);</span><br><span class="line">    deleteString(&amp;buf_U8);</span><br><span class="line">    deleteString(&amp;string_3d8ahnb1_is_U8);</span><br><span class="line">    if ( std::operator!=&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(</span><br><span class="line">           &amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW,</span><br><span class="line">           &amp;unk_30735) )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_19504(&amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW, &quot;U5&quot;);</span><br><span class="line">      CreateStringByChar(&amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW, &apos;3&apos;);</span><br><span class="line">      CreateStringByChar(&amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW, &apos;w&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    if ( *(_DWORD *)(buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW - 12) )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_19504(&amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW, &quot;OAWG&quot;);</span><br><span class="line">      CreateStringByChar(&amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW, &apos;3&apos;);</span><br><span class="line">      CreateStringByChar(&amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW, &apos;3&apos;);</span><br><span class="line">      CreateStringByChar(&amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW, &apos;3&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    CreateStringByChar(&amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW, 119);</span><br><span class="line">    CreateStringByChar(&amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW, 119);</span><br><span class="line">    sub_19504(&amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW, &quot;PZ56GGw0PO02OUW&quot;);</span><br><span class="line">    if ( std::operator==&lt;char&gt;(&amp;newInputKeyBuf, &amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW)</span><br><span class="line">      &amp;&amp; *(_DWORD *)(inputKeyString - 12) == 16 )</span><br><span class="line">    &#123;</span><br><span class="line">      newString1(&amp;buf_BQ366EYdQs3716UCANDOIT666, (int)&quot;BQ366EYdQs3716UCANDOIT666&quot;);</span><br><span class="line">      CreateUnknowStructFunc((int)&amp;string_DU8NABvA, 24);</span><br><span class="line">      hextoString((int)&amp;string_33687_0, 0);</span><br><span class="line">      sub_DD44(&amp;string_0_2, &amp;v106);</span><br><span class="line">      copyStringFromLocation((int)&amp;buf_BQ366EYdQs, &amp;buf_BQ366EYdQs3716UCANDOIT666, 0, 0xAu);</span><br><span class="line">      StringChange((int)&amp;buf_BQ366EYdQs3716UCANDOIT666, (int)&amp;buf_BQ366EYdQs);</span><br><span class="line">      deleteString(&amp;buf_BQ366EYdQs);</span><br><span class="line">      if ( std::operator==&lt;char&gt;(&amp;buf_BQ366EYdQs3716UCANDOIT666, &amp;string_0_2) )</span><br><span class="line">        v2 = (char *)&amp;word_32;</span><br><span class="line">      else</span><br><span class="line">        v2 = (_BYTE *)(&amp;dword_0 + 1);</span><br><span class="line">      deleteString(&amp;string_0_2);</span><br><span class="line">      sub_DBAC(&amp;string_DU8NABvA);</span><br><span class="line">      v37 = &amp;buf_BQ366EYdQs3716UCANDOIT666;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      newString1(&amp;v81, (int)&quot;A782E192B81NICAIsan38Qz&quot;);</span><br><span class="line">      CreateUnknowStructFunc((int)&amp;buf_33687, 24);</span><br><span class="line">      hextoString((int)&amp;v102, 1);</span><br><span class="line">      sub_DD44(&amp;v82, &amp;v103);</span><br><span class="line">      v2 = (_BYTE *)(&amp;stru_908 + 10);</span><br><span class="line">      if ( !std::operator==&lt;char&gt;(&amp;v81, &amp;v82) )</span><br><span class="line">        v2 = (_BYTE *)(&amp;dword_0 + 1);</span><br><span class="line">      if ( std::operator!=&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;v82, &amp;v81) )</span><br><span class="line">      &#123;</span><br><span class="line">        CreateUnknowStructFunc((int)&amp;string_DU8NABvA, 24);</span><br><span class="line">        hextoString((int)&amp;string_33687_0, 33687);</span><br><span class="line">        sub_DD44(&amp;v98, &amp;v106);</span><br><span class="line">        v2 = (char *)std::operator==&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;v98, &quot;0d87a&quot;);</span><br><span class="line">        deleteString(&amp;v98);</span><br><span class="line">        sub_DBAC(&amp;string_DU8NABvA);</span><br><span class="line">      &#125;</span><br><span class="line">      if ( v2 == (_BYTE *)&amp;dword_0 + 1 )</span><br><span class="line">        v2 = (char *)off_35CFC + 303183;</span><br><span class="line">      deleteString(&amp;v82);</span><br><span class="line">      sub_DBAC(&amp;buf_33687);</span><br><span class="line">      v37 = &amp;v81;</span><br><span class="line">    &#125;</span><br><span class="line">    deleteString(v37);</span><br><span class="line">    deleteString(&amp;buf_3ww3U53wOAWG333wwPZ56GGw0PO02OUW);</span><br><span class="line">    deleteString(&amp;newInputKeyBuf);</span><br><span class="line">  &#125;</span><br><span class="line">  deleteString(&amp;inputKeyString);</span><br><span class="line">  return v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="花指令"><a href="#花指令" class="headerlink" title="花指令"></a>花指令</h3><p>里面有一些花指令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if ( ((int (__fastcall *)(int *, char *))operator_equal)(&amp;v63, &amp;v64) )</span><br><span class="line">        v4 = 50;</span><br><span class="line">      else</span><br><span class="line">        v4 = 1;</span><br></pre></td></tr></table></figure>
<p>结尾的指令用于产生一个常量1。<br>而：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if ( v4 == 1 )</span><br><span class="line">  v4 = -1865641388;</span><br></pre></td></tr></table></figure>
<p>还有一些产生了一个字符串，然后if(串非空)将串置空;这样的花指令。</p>
<h3 id="check的主要操作"><a href="#check的主要操作" class="headerlink" title="check的主要操作"></a>check的主要操作</h3><p>函数的主要操作如下：</p>
<ol>
<li>将输入key的jstring对象转换成 cstring对象 。</li>
<li>key长度必须大于等于10，小于等于20。</li>
<li>将输入key置换到最后一位，变成key_change1。</li>
<li>索引 索引 0x7FC2 ，key_change2[i] = 0x7FC2[ key_change1[i]]，得到 key_change2。</li>
<li>将 key_change2按照字节进行低4位与高四位的置换生成 key_change3。</li>
<li>将 key_change3以4字节形式与 0x36098内容进行异或，当处于调试状态是其值为 0xBD9813BA，否则为 0x2333AE83。得到 key_change4,从这里可知key长度为0x10。</li>
<li>将 key_change4相邻2字节交换，得到 key_change5 ，即  key_change5[2i] =  key_change4[2i+1]    key_change5[2i + 1] =  key_change4[2i]。</li>
<li>再次 索引7FC2 ，key_change6[i] = 7FC2[ key_change5 [i]]， 得到 key_change6。</li>
<li>将 key_change6的第一字符置换到最后位置，得到 key_change7。</li>
<li>将 key_change7的所有字符的高4位对字符串“A3Cw6Gb0OZWPU52s ”进行索引，组成 key_change8_highString, 将 key_change7所有字符的低4位对字符串“A3Cw6Gb0OZWPU52s”进行索引，并进行倒序。组成 key_change8_lowString, 然后将 key_change8_highString与 key_change8_lowString进行拼接生成 key_change8</li>
<li>生成字符串“3ww3U53wOAWG333wwPZ56GGw0PO02OUW”。</li>
<li>将 key_change8 与 “3ww3U53wOAWG333wwPZ56GGw0PO02OUW”比较，相等返回1，否则返回其他。</li>
</ol>
<p>wp的其中一种解密代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">def calc1(input):</span><br><span class="line">    l = input[:-1]</span><br><span class="line">    l.insert(0, input[-1])</span><br><span class="line">    r = [chr(i) for i in l]</span><br><span class="line">    print (&apos;[+] calc1: &apos;, r)</span><br><span class="line"> </span><br><span class="line">def calc2(table, input):</span><br><span class="line">    r1 = []</span><br><span class="line">    for i in input:</span><br><span class="line">        for j in range(0, len(table)):</span><br><span class="line">            if i == table[j]:</span><br><span class="line">                r1.append(j)</span><br><span class="line">    print (&apos;[+] calc2: &apos;, r1)</span><br><span class="line">    return r1</span><br><span class="line"> </span><br><span class="line">def calc3(input):</span><br><span class="line">    r1 = []</span><br><span class="line">    for i in input:</span><br><span class="line">        r1.append(((i &gt;&gt; 4) &amp; 0xF) + ((i &amp; 0xF) &lt;&lt; 4))</span><br><span class="line">    print (&apos;[+] calc3: &apos;, r1)</span><br><span class="line">    return r1</span><br><span class="line"> </span><br><span class="line">def calc4(table, input):</span><br><span class="line">    r1 = []</span><br><span class="line">    n = 0</span><br><span class="line">    for i in input:</span><br><span class="line">        if n == 4:</span><br><span class="line">            n = 0</span><br><span class="line">        r1.append(i ^ table[n])</span><br><span class="line">        n += 1</span><br><span class="line">    print (&apos;[+] calc4: &apos;, r1)</span><br><span class="line">    return r1</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def calc5(input):</span><br><span class="line">    for i in range(0, len(input), 2):</span><br><span class="line">        if i % 2 == 0:</span><br><span class="line">            tmp = input[i+1]</span><br><span class="line">            input[i+1] = input[i]</span><br><span class="line">            input[i] = tmp</span><br><span class="line">    print (&apos;[+] calc5: &apos;, input)</span><br><span class="line">    return input</span><br><span class="line"> </span><br><span class="line">def calc6(table, input):</span><br><span class="line">    r1 = []</span><br><span class="line">    for i in input:</span><br><span class="line">        for j in range(0, len(table)):</span><br><span class="line">            if i == table[j]:</span><br><span class="line">                r1.append(j)</span><br><span class="line">    print (&apos;[+] calc6: &apos;, r1)</span><br><span class="line">    return r1</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def calc7(table, s1, s2):</span><br><span class="line">    r1 = []</span><br><span class="line">    for i in s1:</span><br><span class="line">        for j in range(0, len(table)):</span><br><span class="line">            if table[j] == i:</span><br><span class="line">                r1.append(j &lt;&lt; 4)</span><br><span class="line"> </span><br><span class="line">    n = 0</span><br><span class="line">    for i in s2:</span><br><span class="line">        for j in range(0, len(table)):</span><br><span class="line">            if table[j] == i:</span><br><span class="line">                r1[n] = r1[n] + j</span><br><span class="line">                n += 1</span><br><span class="line">    print (&apos;[+] calc7: &apos;, r1)</span><br><span class="line">    return r1</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def calc8(input):</span><br><span class="line">    s1 = input[:15]</span><br><span class="line">    s1 = input[16] + s1</span><br><span class="line">    tmp = input[:15:-1]</span><br><span class="line">    s2 = input[16] + tmp[:15]</span><br><span class="line"> </span><br><span class="line">    print (&apos;[+] calc8:&apos;, s1, s2)</span><br><span class="line">    return s1, s2</span><br><span class="line"> </span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    mainTable = [0x40, 0x50, 0x78, 0x7A, 0x29, 0x88, 0xF7, 0x06, 0x21, 0x09, 0xF3, 0x5C, 0x95, 0xAE, 0x66, 0x12,</span><br><span class="line">0x8F, 0x85, 0xC8, 0x5A, 0xBF, 0x33, 0x3D, 0x86, 0x90, 0x8C, 0xED, 0xD5, 0x8B, 0xA4, 0xC5, 0xC7,</span><br><span class="line">0xEA, 0xF6, 0x79, 0x1E, 0x3C, 0xBA, 0x97, 0x4E, 0x38, 0x60, 0x08, 0xDD, 0xFA, 0xB3, 0xDE, 0x77,</span><br><span class="line">0x81, 0x41, 0x19, 0xF4, 0x52, 0x6B, 0xFF, 0xD8, 0x2A, 0xC2, 0xBC, 0xB9, 0xE7, 0x91, 0xE9, 0x54,</span><br><span class="line">0x82, 0xAD, 0x7E, 0x11, 0x35, 0x93, 0xB0, 0xA1, 0x18, 0xC4, 0x53, 0x0A, 0x74, 0x2F, 0xE2, 0x17,</span><br><span class="line">0x98, 0x0C, 0x70, 0x92, 0x47, 0x64, 0x16, 0xFE, 0x75, 0x83, 0x37, 0x8D, 0x07, 0x72, 0x25, 0x04,</span><br><span class="line">0xB7, 0xC9, 0xCE, 0x0E, 0x9E, 0xEB, 0xCF, 0xB1, 0xDB, 0x71, 0x56, 0xAF, 0x39, 0xF0, 0xBB, 0xBD,</span><br><span class="line">0x46, 0x32, 0xE6, 0x9F, 0x4F, 0x1B, 0x4D, 0x68, 0xF2, 0x4B, 0x2E, 0xCB, 0x20, 0xD2, 0x0B, 0xA5,</span><br><span class="line">0xEE, 0xE1, 0xA9, 0x2B, 0x84, 0x14, 0x67, 0x63, 0x6F, 0x3E, 0x7F, 0xFD, 0xB6, 0xFC, 0x55, 0x7C,</span><br><span class="line">0x5F, 0xF8, 0x4C, 0x65, 0x2C, 0x30, 0xEF, 0x48, 0xD7, 0x0D, 0x0F, 0x1A, 0x5E, 0xC0, 0x3A, 0x57,</span><br><span class="line">0x6A, 0x31, 0x00, 0xF1, 0x59, 0x10, 0xB8, 0x9A, 0x43, 0x73, 0xA3, 0x6E, 0x26, 0x1D, 0x13, 0x15,</span><br><span class="line">0x89, 0x5D, 0xDA, 0x61, 0xD1, 0x6C, 0xD3, 0xE0, 0xD9, 0x1F, 0xD4, 0x49, 0xEC, 0xE3, 0xD0, 0x34,</span><br><span class="line">0x36, 0xC6, 0x24, 0xE4, 0xF5, 0xAA, 0x9B, 0xB2, 0x4A, 0xDF, 0xAC, 0x96, 0xDC, 0xE8, 0xA0, 0xF9,</span><br><span class="line">0xC1, 0x9C, 0xCA, 0x9D, 0x27, 0xC3, 0xBE, 0x87, 0x28, 0xCC, 0x99, 0xE5, 0x45, 0x58, 0x94, 0x23,</span><br><span class="line">0x22, 0xFB, 0x02, 0x01, 0x03, 0x8A, 0x7B, 0xB5, 0x1C, 0xA7, 0x44, 0xCD, 0xA2, 0x51, 0x8E, 0x3F,</span><br><span class="line">0x42, 0xD6, 0x69, 0xAB, 0x62, 0x3B, 0x7D, 0xA6, 0x05, 0x2D, 0xA8, 0x80, 0x6D, 0xB4, 0x76, 0x5B]</span><br><span class="line"> </span><br><span class="line">    table = [&apos;A&apos;, &apos;3&apos;, &apos;C&apos;, &apos;w&apos;, &apos;6&apos;, &apos;G&apos;, &apos;b&apos;, &apos;0&apos;, &apos;O&apos;, &apos;Z&apos;, &apos;W&apos;, &apos;P&apos;, &apos;U&apos;, &apos;5&apos;, &apos;2&apos;, &apos;s&apos;]</span><br><span class="line">    txor = [0x83, 0xAE, 0x33, 0x23]</span><br><span class="line"> </span><br><span class="line">    s1, s2 = calc8(&apos;3ww3U53wOAWG333wwPZ56GGw0PO02OUW&apos;)</span><br><span class="line">    key1 = calc7(table, s1, s2)</span><br><span class="line">    key2 = calc6(mainTable, key1)</span><br><span class="line">    key3 = calc5(key2)</span><br><span class="line">    key4 = calc4(txor, key3)</span><br><span class="line">    key5 = calc3(key4)</span><br><span class="line">    key6 = calc2(mainTable, key5)</span><br><span class="line">    calc1(key6)</span><br></pre></td></tr></table></figure>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2018-07-03T23:21:44.455Z" itemprop="dateUpdated">2018-07-04 07:21:44</time>
</span><br>


        
        感谢阅读
        
    </div>
    
    <footer>
        <a href="http://www.w4ter5heep.com">
            <img src="/img/gogo.jpg" alt="W4ter5heep">
            W4ter5heep
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/">CTF</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.w4ter5heep.com/2018/07/03/看雪CTF第五题——ExecuteTable/&title=《看雪CTF——ExecuteTable》 — W4ter5heep's site&pic=http://www.w4ter5heep.com/img/gogo.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.w4ter5heep.com/2018/07/03/看雪CTF第五题——ExecuteTable/&title=《看雪CTF——ExecuteTable》 — W4ter5heep's site&source=Coding is fun!" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.w4ter5heep.com/2018/07/03/看雪CTF第五题——ExecuteTable/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《看雪CTF——ExecuteTable》 — W4ter5heep's site&url=http://www.w4ter5heep.com/2018/07/03/看雪CTF第五题——ExecuteTable/&via=http://www.w4ter5heep.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.w4ter5heep.com/2018/07/03/看雪CTF第五题——ExecuteTable/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="waves-block waves-effect next">
      <a href="/2018/06/04/SUCTF复盘——三个RE/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">SUCTF复盘——三个RE</h4>
      </a>
    </div>
  
</nav>



    

















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>W4ter5heep &copy; 2018</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.w4ter5heep.com/2018/07/03/看雪CTF第五题——ExecuteTable/&title=《看雪CTF——ExecuteTable》 — W4ter5heep's site&pic=http://www.w4ter5heep.com/img/gogo.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.w4ter5heep.com/2018/07/03/看雪CTF第五题——ExecuteTable/&title=《看雪CTF——ExecuteTable》 — W4ter5heep's site&source=Coding is fun!" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.w4ter5heep.com/2018/07/03/看雪CTF第五题——ExecuteTable/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《看雪CTF——ExecuteTable》 — W4ter5heep's site&url=http://www.w4ter5heep.com/2018/07/03/看雪CTF第五题——ExecuteTable/&via=http://www.w4ter5heep.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.w4ter5heep.com/2018/07/03/看雪CTF第五题——ExecuteTable/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACtklEQVR42u3aQXLjQAgF0Nz/0p6qWSU1kfWBRuPF08ol23K/XjQY+PqKr9ff6+r+93eTO/8+8/1nrt49duHh4eG1ln51vV/K1Wfeb1Dy/HwTb7YADw8Pb42XLCg5svM7+WblW4mHh4f3abxJclxeVisI4eHh4X0aL0mdq6WEV3Dla8DDw8N7kpc8Or8zeeb7py3WWvDw8PBiXrUB9gmvF/t7eHh4eIOu+iTN7Y0C9ELF5Qrx8PDwFnhJ4TU/eyfNrerrQsDAw8PDW+DlwwHzNv/ZEYFRrRoPDw+vxesd2b1G18ZZfZPE4+Hh4S3wkqP2bGs/ScerCXoz98fDw8Nr8fLl9u4kLf/qRuefwcPDw9vgVUed9gLJJJzcfBcPDw9vjZf/sa8uIj/iq+WPUY8ODw8Pr8XrtZryku4EcKBAjIeHh7fbeyoUESbpeJJSJ2l61PTCw8PDe5CXJ6/V8anqQvMtuHkXDw8Pb42XfC1PxHsBoFpPiIIEHh4e3iHeqQS3OsxaLTE0S8x4eHh4j/Am4SF/Qv46LyX/8ut4eHh4C7zqSMFGjTQvSfRKw3h4eHhP8noL7RVw8zCQF47x8PDwNngbrfqkOJsXKapp+o87eHh4eAu8+Z//XnioJspJSfdytXh4eHjLvNfg6hUOesMBhd/Fw8PDW+DNm1jzAmseHqpNOzw8PLwNXl5cyEu0k4R7kpTfxD08PDy8o7xq6eFsEjwZXLhZFR4eHt5R3rz5VN2OCbsaMPDw8PA2eL1IkhcpTg1yJc/Hw8PDe5KXFwIm1Pygr44aRKMDeHh4eAu86kGflFOrownNqJVPRuDh4eH9V171x+blhjxsRJk7Hh4e3iO8vNRbHSlItqaaguPh4eFt86rLzYutvfDQC0KFGIWHh4c34PUaYNU7+TZVt+wAEg8PDy/l/QEnMkEFZyWoCAAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '你看不到我了哦！';
            clearTimeout(titleTime);
        } else {
            document.title = '哇，你回来了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
